# Project Status

- Last Updated: 2026-02-19 (e2e-visual-baselines-merge)

- Current progress:
  - Unified browser testing so E2E interaction tests and visual snapshot tests coexist cleanly:
    - kept `playwright.config.ts` focused on `tests/e2e`,
    - added `playwright.visual.config.ts` for `tests/visual`,
    - updated root scripts to run each suite explicitly (`test:e2e*`, `test:visual*`).
  - Extended browser `VITE_E2E=1` runtime fixtures for visual stability without regressing Kanban/E2E coverage:
    - preserved full `tauri-e2e` command surface used by workspace/kanban flows,
    - added deterministic git/worktree/GitHub fixture responses and synthetic pane output for high-signal visual snapshots,
    - switched browser persistence fallback to localStorage key `super-vibing:e2e-payload` so Playwright seed data can control startup state.
  - Updated CI to run both suites:
    - `e2e` job for behavior specs,
    - `visual` job for screenshot assertions,
    - separate Playwright artifacts on failure (`playwright-report-e2e`, `playwright-report-visual`).
  - Verification:
    - `pnpm --filter @supervibing/desktop typecheck` ✅
    - `pnpm test:e2e` ✅
    - `pnpm test:visual` ✅
  - Blockers/Bugs:
    - no functional blockers found in this pass.
  - Next immediate starting point:
    - add visual baselines for destructive confirmation surfaces in Git/Worktree flows (commit/discard/delete/prune dialogs) and include masks for volatile timestamps/status badges.

  - Historical progress:
  - Split app navigation sections into first-class page routes instead of terminal-only embedding:
    - added section route mapper helpers in `apps/desktop/src/lib/section-routes.ts` with canonical paths (`/terminal`, `/git`, `/worktrees`, `/kanban`, `/agents`, `/prompts`, `/settings`),
    - wired `App.tsx` to hydrate section state from URL on load/popstate and push browser history on section changes,
    - moved non-terminal section rendering behind a dedicated page wrapper (`.app-page`) while keeping terminal grids mounted only as terminal surface state,
    - removed forced `terminal` redirect on sidebar workspace switch so workspace changes do not collapse page routing context.
  - Added route/page regression coverage:
    - new `apps/desktop/src/lib/section-routes.test.ts` for section/path normalization and fallback behavior,
    - expanded `apps/desktop/src/App.terminal-persistence.test.tsx` for URL hydration, popstate updates, unknown-path normalization, and workspace switch behavior.
  - Implemented first-class Kanban orchestration across desktop frontend/store/backend:
    - unlocked Kanban in sidebar/app routing and replaced placeholder view with `KanbanSection`,
    - implemented task create/update/move/run/done flows with persisted state sync and run-log polling in `apps/desktop/src/store/workspace.ts`,
    - added pre-run branch/worktree automation hooks for task runs (create/rebind/import worktree, optional checkout branch before command execution),
    - added backend Kanban runtime state + Tauri commands + automation HTTP endpoints in `apps/desktop/src-tauri/src/lib.rs`,
    - wired PTY output capture into active Kanban runs for incremental log streaming.
  - Added Kanban UI and UX/test coverage:
    - added `apps/desktop/src/components/KanbanSection.tsx` (task form, column board, run controls, log preview),
    - added Kanban style system in `apps/desktop/src/styles.css` with responsive board/card layout,
    - updated `apps/desktop/src/components/AppSidebar.test.tsx` and `apps/desktop/src/components/CommandPalette.test.tsx` for unlocked Kanban navigation/actions.
  - Verification:
    - `pnpm --filter @supervibing/desktop typecheck` ✅
    - `pnpm --filter @supervibing/desktop test -- run src/lib/section-routes.test.ts src/App.terminal-persistence.test.tsx src/components/AppSidebar.test.tsx src/components/CommandPalette.test.tsx` ✅
    - `cargo check --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
  - Blockers/Bugs:
    - no functional blockers found in this pass.
  - Next immediate starting point:
    - run in-app manual validation for Kanban pre-run worktree/branch flows and live run-log streaming on real pane commands,
    - add end-to-end tests for section deep-link + back/forward navigation alongside Kanban run lifecycle once app-level automation test harness is available.

  - Historical progress:
  - Recovered failed `Release` workflow caused by tag/version mismatch on `v0.1.22`:
    - bumped release manifests to `0.1.23` (`package.json`, `apps/desktop/package.json`, `apps/desktop/src-tauri/tauri.conf.json`),
    - committed and pushed `main` (`0a58a02`),
    - created and pushed tag `v0.1.23`.
  - Verification:
    - `pnpm run release:prepare -- 0.1.23` ✅
    - GitHub Actions `CI` run `22111678902` ✅
    - GitHub Actions `Release` run `22111681951` ✅
  - Blockers/Bugs:
    - Historical failed run for tag `v0.1.22` remains visible in Actions history by design.
  - Next immediate starting point:
    - continue normal feature work from `main`; use guarded release flow (`pnpm run release:prepare -- X.Y.Z` then tag) for the next cut.

  - Historical progress:
  - Fixed terminal history clearing when toggling pane zoom on/off:
    - refactored `apps/desktop/src/components/PaneGrid.tsx` to keep all `TerminalPane` instances mounted in one stable render path,
    - converted zoom behavior to CSS/view-state (`is-zoom-target` and `is-zoom-hidden`) instead of rendering a zoom-only subtree,
    - disabled freeform drag/resize/layout-change callbacks while zoomed so zoom remains a visual mode and does not mutate layouts.
  - Added zoom persistence regression coverage:
    - `apps/desktop/src/components/PaneGrid.test.tsx` now verifies all terminal panes remain mounted in zoom mode and across zoom toggle transitions,
    - added assertions that zoomed freeform mode suppresses drag/resize/layout mutations.
  - Verification:
    - `pnpm install` ✅ (restored workspace package links for `@supervibing/ui` resolution in local env)
    - `pnpm --filter @supervibing/desktop test -- run src/components/PaneGrid.test.tsx src/App.terminal-persistence.test.tsx` ✅ (18/18 files, 123/123 tests)
    - `pnpm --filter @supervibing/desktop typecheck` ✅
  - Released version bump to 0.1.21:
    - updated release manifests to 0.1.21,
    - created and pushed tag `v0.1.21` to `origin`.
  - Completed shadcn compact refresh pass across shared UI package and desktop surfaces:
    - converted `@supervibing/ui` primitives to token-native shadcn styles (no dependency on legacy app CSS class skins),
    - replaced token bridge with a two-theme contract (`apple-dark`, `apple-light`) and compact-first spacing defaults,
    - reduced theme model in frontend types/theme definitions from six presets to two supported presets,
    - changed session/UI default density from `comfortable` to `compact` in store defaults/reset paths.
  - Rebuilt desktop visual layer for compact, clean shadcn styling:
    - rewrote `apps/desktop/src/styles.css` into a token-driven structural stylesheet,
    - removed legacy “Soft UI Minimalism 2.0” override block and duplicated skinning rules,
    - updated style contract tests to validate the new shadcn compact contract.
  - Verification:
    - `pnpm --filter @supervibing/desktop typecheck` ✅
    - `pnpm --filter @supervibing/desktop test -- run` ✅ (18/18 files, 121/121 tests)
    - `pnpm --filter @supervibing/desktop build` ✅
    - `cargo check --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
  - Blockers/Bugs:
    - No functional blockers found in current compact refresh pass.
  - Next immediate starting point:
    - continue removing no-op legacy className shims (`subtle-btn`, `primary-btn`, etc.) from desktop TSX now that primitive styling is fully token-native,
    - add a visual regression snapshot baseline for dark/light compact themes.

  - Historical progress:
  - Completed shadcn/ui migration foundation with shared workspace package:
    - added `@supervibing/ui` package surface under `packages/ui/src` with shadcn-style primitives (`Button`, `Input`, `Dialog`, `Command`, `Badge`, `Checkbox`, `ScrollArea`, etc.),
    - added token bridge stylesheet export `@supervibing/ui/styles.css`,
    - added Tailwind preset scaffold at `packages/ui/tailwind.preset.ts`,
    - wired desktop app to consume package via `workspace:*` dependency.
  - Migrated major desktop UI surfaces to shared primitives:
    - `apps/desktop/src/components/AppSidebar.tsx`,
    - `apps/desktop/src/components/TopChrome.tsx`,
    - `apps/desktop/src/components/CommandPalette.tsx`,
    - `apps/desktop/src/components/NewWorkspaceModal.tsx`,
    - `apps/desktop/src/components/NewPaneModal.tsx`,
    - `apps/desktop/src/components/WorktreeManagerSection.tsx`,
    - `apps/desktop/src/components/GitSection.tsx` (toolbar/list/detail interactions),
    - `apps/desktop/src/components/PaneGrid.tsx`,
    - `apps/desktop/src/components/git/GitActionConfirmModal.tsx`,
    - `apps/desktop/src/components/EmptyStatePage.tsx`,
    - `apps/desktop/src/components/StartupCrashScreen.tsx`.
  - Updated desktop build wiring for shared UI package:
    - `apps/desktop/src/main.tsx` now imports `@supervibing/ui/styles.css`,
    - `apps/desktop/tailwind.config.ts` now scans `../../packages/ui/src/**/*.{ts,tsx}`.
  - Verification:
    - `pnpm --filter @supervibing/desktop typecheck` ✅
    - `pnpm --filter @supervibing/desktop test -- run src/components/AppSidebar.test.tsx src/components/CommandPalette.test.tsx src/components/NewWorkspaceModal.test.tsx src/components/NewPaneModal.test.tsx src/components/PaneGrid.test.tsx` ✅
      - run scope passed (18/18 files, 121/121 tests).
    - `pnpm --filter @supervibing/desktop build` ✅
    - `cargo check --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
  - Blockers/Bugs:
    - No functional blockers found in current migration pass.
    - No outstanding migration regressions in current validated test/build scope.
  - Next immediate starting point:
    - completed in pass 2 (`App.tsx` controls + dialog descriptions + prompt/confirm removal),
    - remaining follow-up is ongoing CSS deduplication and shared-style consolidation.

  - Historical progress:
  - Implemented a new keyboard-first `Git` section in desktop app navigation:
    - `apps/desktop/src/components/GitSection.tsx` adds 3-pane control center (`Status`, `Branches`, `Worktrees`, `PRs`, `Issues`, `Actions`) scoped to active workspace repository.
    - `apps/desktop/src/store/gitView.ts` adds view-state slice for active git panel, focus zone, and per-panel cursors.
    - `apps/desktop/src/components/AppSidebar.tsx` and `apps/desktop/src/components/TopChrome.tsx` now expose first-class `Git` navigation context.
  - Added local git backend command surface in `apps/desktop/src-tauri/src/lib.rs`:
    - status/diff/stage/unstage/discard/commit/fetch/pull/push,
    - branch list/checkout/create/delete,
    - path and repo validation plus command output truncation guardrails.
  - Added GitHub (`gh`) backend command surface in `apps/desktop/src-tauri/src/lib.rs`:
    - PR list/detail/checkout/comment/squash-merge,
    - issue list/detail/comment/label-edit/assignee-edit,
    - workflow list/run list/run detail/rerun-failed/cancel.
  - Added frontend bridge + typing for git/GitHub commands:
    - `apps/desktop/src/lib/tauri.ts` now exports typed `invoke` wrappers for all new commands.
    - `apps/desktop/src/types.ts` now includes git status/branch and GitHub PR/issue/workflow/run DTOs.
  - Added Git command palette jump actions:
    - `apps/desktop/src/components/CommandPalette.tsx` now supports quick jumps to Git section, PR panel, and Actions panel.
  - Added confirm modal and action safety UX:
    - `apps/desktop/src/components/git/GitActionConfirmModal.tsx` handles destructive-action confirmation.
    - `GitSection` routes `x`-style destructive operations through explicit confirmation flow.
  - Added Git section styling in `apps/desktop/src/styles.css` with Soft UI contract compatibility (no hard 1px border declarations in override layer).
  - Added focused pane-create action for tmux `Prefix + C`:
    - new store action `addPaneToActiveWorkspaceAndFocus()` in `apps/desktop/src/store/workspace.ts`,
    - `apps/desktop/src/App.tsx` now routes only `Ctrl+B` then `c` to the focused-create action,
    - `%` and `"` mappings remain on `setActiveWorkspacePaneCount(...)` (existing split behavior unchanged).
  - Added regressions for cursor-follow behavior on pane create:
    - `apps/desktop/src/App.shortcuts.test.ts` now verifies `prefix+c` calls focused-create action and does not fall back to generic pane-count increment,
    - `apps/desktop/src/store/workspace.test.ts` now verifies pane add + focus/focus-request move to the new pane.
  - Hardened Discord Rich Presence reliability and responsiveness:
    - backend switched from `discord-rpc-client` to `discord-rich-presence` (IPC path scan support across `discord-ipc-0..9`),
    - backend `set_discord_presence_enabled` is now non-blocking (queue-only command path),
    - added dedicated background presence worker with latest-toggle coalescing and retry/healthcheck loop while enabled.
  - Preserved frontend fail-open presence behavior:
    - Settings toggle remains optimistic and persisted in session state (`discordPresenceEnabled`),
    - backend transport failures remain non-fatal to prevent UI lockups.
  - Extended discord coverage:
    - Rust unit coverage for app-id parsing and command coalescing helpers,
    - store tests now verify failed backend apply does not revert toggle and rapid toggles preserve final state.
  - Fixed discord presence snapshot restore typing:
    - ensure snapshot restore re-sanitizes `discordPresenceEnabled` before applying presence.
  - Updated tmux close-key behavior for one-pane workspaces:
    - `apps/desktop/src/App.tsx` now routes `Ctrl+B` then `x`/`&` to `closeWorkspace(workspaceId)` when active workspace has exactly one pane.
    - multi-pane behavior remains unchanged (`paneCount - 1` via `setActiveWorkspacePaneCount`).
    - last-workspace safety remains store-owned (`closeWorkspace` no-ops when only one workspace exists).
  - Added shortcut regressions for one-pane close flow:
    - `apps/desktop/src/App.shortcuts.test.ts` now verifies `prefix+x` and `prefix+&` close workspace at one pane and do not call pane-count decrement.
  - Fixed tmux pane focus/cursor sync in terminal UI:
    - added runtime `focusRequestByWorkspace` signal in `apps/desktop/src/store/workspace.ts`,
    - threaded focus request through `apps/desktop/src/App.tsx` and `apps/desktop/src/components/PaneGrid.tsx`,
    - `apps/desktop/src/components/TerminalPane.tsx` now calls `terminal.focus()` when pane focus is moved by tmux shortcuts.
  - Added regression coverage for focus-follow behavior:
    - `apps/desktop/src/components/PaneGrid.test.tsx` verifies only requested pane gets focus request,
    - `apps/desktop/src/components/TerminalPane.test.tsx` verifies `terminal.focus()` runs on focus request,
    - `apps/desktop/src/store/workspace.test.ts` verifies focus request state updates with focused pane actions.
  - Added per-pane worktree bindings in workspace runtime state:
    - `apps/desktop/src/types.ts` now includes `PaneModel.worktreePath`,
    - `apps/desktop/src/store/workspace.ts` now spawns panes with pane-level cwd/worktree instead of always using workspace-level path,
    - session sanitize/migration paths now backfill pane worktree paths for older persisted data.
  - Added pane-level worktree lifecycle actions in store:
    - `createPaneWithWorktree(workspaceId, worktreePath)` creates and spawns a new pane bound to a selected worktree,
    - `setPaneWorktree(workspaceId, paneId, worktreePath, { restartRunning })` updates pane binding and optionally restarts running panes safely,
    - `createWorktreeForWorkspace(workspaceId, { mode, branch, baseRef })` enables modal-driven worktree creation without forcing workspace import.
  - Added floating pane worktree creator UX:
    - new `apps/desktop/src/components/NewPaneModal.tsx` with `existing worktree` and `create branch worktree` flows,
    - `apps/desktop/src/App.tsx` wires modal from terminal toolbar and pane header actions.
  - Added tmux mapping for worktree pane flow:
    - `Ctrl+B` then `W` now opens pane creator modal,
    - app `Escape` overlay handling now closes pane creator between new-workspace modal and sidebar paths.
  - Added pane header worktree affordances:
    - `apps/desktop/src/components/PaneGrid.tsx` now renders pane title + worktree label and contextual `Worktree` action,
    - per-pane worktree reassignment flow supports confirm-and-restart for running panes.
  - Added frontend dependency parity needed by current tauri bridge helpers:
    - `@tauri-apps/plugin-dialog` added to `apps/desktop/package.json` (matches existing `src/lib/tauri.ts` import usage).
  - Added tmux-style workspace cycling in frontend shortcuts:
    - `apps/desktop/src/App.tsx` now maps `Ctrl+B` prefix + `)`/`(` to next/previous workspace activation with wrap-around order.
    - tmux shortcut context now includes workspace order + active workspace setter for prefix-driven workspace switching.
    - Settings shortcut list now documents `Prefix + ) / (` for workspace navigation.
  - Added regression coverage for workspace prefix navigation:
    - `apps/desktop/src/App.shortcuts.test.ts` now verifies next/previous workspace switching, boundary wrap-around, and one-workspace no-op behavior.
  - Implemented native directory picker for new workspace creation:
    - `apps/desktop/src/components/NewWorkspaceModal.tsx` now supports `Browse` + `Reset` while keeping manual path entry,
    - picker errors are shown inline in the modal and do not block manual entry or submit flow,
    - directory browse is wired through new helper `pickDirectory` in `apps/desktop/src/lib/tauri.ts`.
  - Enabled Tauri dialog plugin for desktop runtime:
    - frontend dependency added: `@tauri-apps/plugin-dialog`,
    - Rust plugin registered in `apps/desktop/src-tauri/src/lib.rs`,
    - capability permission added: `dialog:default` in `apps/desktop/src-tauri/capabilities/default.json`.
  - Added regression coverage for path picker UX:
    - new `apps/desktop/src/components/NewWorkspaceModal.test.tsx` covers browse success, cancel, error handling, and submit with picked path.
  - Hardened release/version pipeline guardrails:
    - `scripts/verify-release-version.sh` now validates parity across root/desktop/tauri manifests plus release tag,
    - failure output now reports all detected versions and a direct remediation command.
  - Added automated release-prep helper:
    - new `scripts/prepare-release-version.sh`,
    - root pnpm commands `release:prepare` and `release:verify` for local/CI parity consistency.
  - Added guarded release-tag helper:
    - new `scripts/create-release-tag.sh`,
    - root pnpm command `release:tag` blocks tag creation unless the repo is clean and parity-ready.
  - Updated release workflow parity step in `.github/workflows/release.yml` to invoke `pnpm run release:verify -- <tag>`.
  - Applied release recovery metadata alignment:
    - `package.json`, `apps/desktop/package.json`, and `apps/desktop/src-tauri/tauri.conf.json` are now set to version `0.1.13`.
    - release tag `v0.1.13` was published and GitHub `Release` workflow run `21970252972` completed successfully.
  - Worktree manager system remains in place across backend/store/UI with enriched worktree metadata and safe lifecycle actions.
  - Added local automation bridge in `apps/desktop/src-tauri/src/lib.rs`:
    - HTTP listener uses preferred bind from `SUPERVIBING_AUTOMATION_BIND` (default `127.0.0.1:47631`) with fallback scan `127.0.0.1:47631..47641`,
    - endpoints `GET /v1/health`, `GET /v1/workspaces`, `POST /v1/commands`, `GET /v1/jobs/:jobId`,
    - queued async job processing for:
      - `create_panes`,
      - `create_worktree`,
      - `create_branch`,
      - `run_command`.
  - Added frontend handshake for UI-owned automation actions in `apps/desktop/src/App.tsx`:
    - listens to `automation:request`,
    - applies `create_panes` / `import_worktree`,
    - reports completion/failure with `automation_report`.
  - Added workspace runtime snapshot sync from Zustand to backend in `apps/desktop/src/store/workspace.ts`:
    - `syncAutomationWorkspaces` called during bootstrap/workspace lifecycle/pane lifecycle changes.
  - Patched backend reliability path so pending frontend acks are cleaned up on emit failure and timeout.
  - Added global Codex skill at `~/.codex/skills/supervibing-automation`:
    - `SKILL.md` with usage workflow and troubleshooting,
    - `scripts/supervibing_automation.py` wrapper CLI for health/workspaces/job and bridge command actions,
    - `agents/openai.yaml` for UI metadata,
    - wrapper now auto-discovers fallback bridge port range when implicit default URL is used.
  - Wrapper defaults are aligned with product decisions:
    - submit-and-wait by default,
    - optional `--no-wait`,
    - health-check-only app lifecycle (no auto-start).
  - Extended inactive workspace lifetime in `apps/desktop/src/store/workspace.ts`:
    - `INACTIVE_WORKSPACE_SUSPEND_MS` increased from `120s` to `10m` to keep workspaces alive longer before auto-suspend.
  - Fixed workspace-switch terminal clearing in frontend:
    - `apps/desktop/src/App.tsx` now keeps all workspace `PaneGrid` instances mounted in Terminal section,
    - inactive workspace grids are hidden (not unmounted), preserving xterm buffer state,
    - `apps/desktop/src/styles.css` adds stacked grid panel visibility classes.
  - Fixed terminal history clearing when leaving Terminal section (e.g., Settings) and coming back:
    - `apps/desktop/src/App.tsx` now keeps terminal surface mounted whenever workspaces exist and toggles visibility via `hidden/aria-hidden`,
    - `PaneGrid` `isActive` now depends on both active section and active workspace (`isTerminalSection && workspace.id === activeWorkspaceId`) so refit/resize behavior remains correct on return,
    - added regression coverage in `apps/desktop/src/App.terminal-persistence.test.tsx` to prevent unmount regressions across `Terminal -> Settings -> Terminal`.
  - Fixed terminal copy + initial glyph spacing issues in frontend:
    - `apps/desktop/src/components/TerminalPane.tsx` now handles `Ctrl+Shift+C` via xterm custom key handler and copies current selection to clipboard,
    - empty-selection copy chord is consumed as no-op (no terminal input),
    - startup now performs staged refit/resize (open, next frame, fonts-ready) and refits again when a hidden workspace pane becomes active,
    - `apps/desktop/src/App.tsx` + `apps/desktop/src/components/PaneGrid.tsx` pass active visibility state to `TerminalPane`.
  - Added tmux-style core shortcut profile in frontend:
    - `apps/desktop/src/App.tsx` now uses a `Ctrl+B` prefix controller with a `1000ms` timeout and tmux-like pane mappings (`%`, `"`, `c`, `n`, `p`, `o`, `0..9`, arrows, `z`, `x`, `&`, `Alt+Arrow`),
    - app prefix handling remains active inside terminal pane input scope, so `Ctrl+B` is consumed by the app when tmux shortcut context is eligible,
    - legacy non-tmux pane hotkeys were removed from the global app shortcut handler; global app keys (`Ctrl/Cmd+N`, `Ctrl/Cmd+P`, `Escape`) remain,
    - Settings shortcut list now reflects tmux core bindings.
  - Added keyboard resize support for focused panes in freeform mode:
    - `apps/desktop/src/store/workspace.ts` includes `resizeFocusedPaneByDelta(workspaceId, dx, dy)` used by tmux `prefix+Alt+Arrow`,
    - resize is no-op outside freeform mode.
  - Added startup crash recovery and renderer failure guardrails:
    - frontend root is wrapped by `StartupErrorBoundary` in `apps/desktop/src/main.tsx`,
    - startup/runtime global listeners now log `[startup]` `error` and `unhandledrejection` events,
    - new recovery UI `apps/desktop/src/components/StartupCrashScreen.tsx` provides `Retry`, `Reset local data`, and detail toggle.
  - Hardened bootstrap failure handling in `apps/desktop/src/store/workspace.ts`:
    - added `startupError` state and fail-safe bootstrap `try/catch`,
    - added `clearStartupError` and `resetLocalStateAndRebootstrap`,
    - added persistence reset API `resetPersistedPayload` in `apps/desktop/src/lib/persistence.ts`.
  - Added regression coverage for startup recovery:
    - `apps/desktop/src/components/StartupErrorBoundary.test.tsx`,
    - `apps/desktop/src/lib/persistence.test.ts`,
    - extended `apps/desktop/src/store/workspace.test.ts` with bootstrap failure and reset+rebootstrap scenarios.
  - Fixed React external-store rerender loop risk in frontend selector wiring:
    - `apps/desktop/src/App.tsx` now separates worktree manager core selector from derived open-workspace paths selector,
    - removed nested inline `.map()` output from a `useShallow` object selector to keep snapshot comparisons stable under React 19,
    - added selector stability regressions in `apps/desktop/src/App.selectors.test.ts`.
  - Added global agent startup defaults in frontend settings/store:
    - `apps/desktop/src/store/workspace.ts` now persists `agentStartupDefaults` in session state and applies them to newly created/imported workspaces,
    - `apps/desktop/src/App.tsx` Settings now provides editable per-agent startup commands and a reset action,
    - `apps/desktop/src/components/NewWorkspaceModal.tsx` now seeds agent command defaults from global settings.
  - Fixed keyboard shortcuts while terminal pane has focus:
    - `apps/desktop/src/components/TerminalPane.tsx` marks terminal shortcut scope with `data-terminal-pane`,
    - `apps/desktop/src/App.tsx` no longer treats xterm input focus as a generic editable-target block for app/tmux shortcut handling,
    - window keydown listener now uses capture phase so app-prefixed pane shortcuts remain reliable around terminal event propagation.
  - Hardened worktree lifecycle UX coverage:
    - `apps/desktop/src/store/workspace.test.ts` now covers managed worktree create-without-open and remove-with-open-workspace cleanup paths.
  - Hardened Rust automation bridge request surface in `apps/desktop/src-tauri/src/lib.rs`:
    - optional bearer-token auth via `SUPERVIBING_AUTOMATION_TOKEN`,
    - request validation before queueing (`workspaceId`, `paneCount`, branch/command checks),
    - queue-full returns `429` and expanded HTTP status mapping,
    - completed-job retention cap to bound in-memory automation job growth,
    - health response bind field now reflects runtime-selected bridge bind address.

- Verification:
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/components/AppSidebar.test.tsx src/components/CommandPalette.test.tsx tests/styles.soft-ui.test.ts` ✅
    - desktop tests passed (18/18 files, 121/121 tests in resolved run scope).
  - `cargo check --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
  - `cargo test --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
    - Rust tests passed (27/27).
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/store/workspace.test.ts src/App.terminal-persistence.test.tsx` ✅
    - desktop tests passed (18/18 files, 121/121 tests in resolved run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `cargo check --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
  - `cargo test --manifest-path apps/desktop/src-tauri/Cargo.toml` ✅
    - Rust tests passed (23/23).
  - `pnpm --filter @supervibing/desktop test -- run src/store/workspace.test.ts` ✅
    - desktop tests passed (18/18 files, 119/119 tests in resolved run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts` ✅
    - desktop tests passed (18/18 files, 115/115 tests in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/store/workspace.test.ts src/components/PaneGrid.test.tsx src/components/TerminalPane.test.tsx src/App.shortcuts.test.ts src/App.terminal-persistence.test.tsx` ✅
    - desktop tests passed (18/18 files, 113/113 tests in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/components/PaneGrid.test.tsx src/components/NewPaneModal.test.tsx src/store/workspace.test.ts src/components/CommandPalette.test.tsx src/App.terminal-persistence.test.tsx` ✅
    - vitest passed (18/18 files, 110/110 tests in resolved run scope).
  - `pnpm --filter @supervibing/desktop test -- run src/components/NewWorkspaceModal.test.tsx` ✅
    - desktop tests passed (99/99 in current run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts` ✅
    - desktop tests passed (97/97 in run scope).
  - `cargo check` (in `apps/desktop/src-tauri`) ✅
  - `pnpm run release:verify -- v0.1.11` ✅
  - `pnpm run release:tag -- 0.1.13` ✅ expected fail on dirty tree (guard behavior verified).
  - `pnpm run release:prepare -- 0.1.13` ✅
  - `pnpm run release:tag -- 0.1.13` ✅ created local annotated tag `v0.1.13` on release commit.
  - `git push origin refs/heads/main` ✅
  - `git push origin refs/tags/v0.1.13` ✅
  - `gh run view 21970252972 --json status,conclusion,url` ✅
    - status `completed`, conclusion `success`, URL `https://github.com/hizawye/super-vibing/actions/runs/21970252972`.
  - `pnpm run release:verify -- v0.1.10` ✅ (before version bump, parity passed at `0.1.10`)
  - `pnpm run release:verify -- v0.1.11` ✅ expected fail before bump (mismatch surfaced with remediation hint)
  - `pnpm run release:prepare -- 0.1.11` ✅
  - `pnpm run release:verify -- v0.1.11` ✅ (after version bump)
  - `cargo test -q` (in `apps/desktop/src-tauri`) ✅
    - Rust tests passed (10/10).
  - `cargo check -q` (in `apps/desktop/src-tauri`) ✅
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/store/workspace.test.ts src/components/CommandPalette.test.tsx src/components/AppSidebar.test.tsx tests/styles.soft-ui.test.ts` ✅
    - desktop tests passed (63/63 in run scope).
  - `python3 ~/.codex/skills/supervibing-automation/scripts/supervibing_automation.py --help` ✅
  - `python3 ~/.codex/skills/supervibing-automation/scripts/supervibing_automation.py create-worktree --help` ✅
  - `python3 ~/.codex/skills/supervibing-automation/scripts/supervibing_automation.py --json health` executed and returned `connection refused` (expected while app bridge is not running) ✅
  - `pnpm --filter @supervibing/desktop test -- run src/store/workspace.test.ts` ✅
    - workspace/store and related desktop tests passed (63/63 in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/components/PaneGrid.test.tsx src/components/AppSidebar.test.tsx src/components/CommandPalette.test.tsx` ✅
    - desktop tests passed (63/63 in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/components/PaneGrid.test.tsx src/components/TerminalPane.test.tsx` ✅
    - desktop tests passed (68/68 in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/store/workspace.test.ts` ✅
    - desktop tests passed (77/77 in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/store/workspace.test.ts src/components/StartupErrorBoundary.test.tsx src/lib/persistence.test.ts` ✅
    - desktop tests passed (82/82 in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.selectors.test.ts src/App.shortcuts.test.ts src/store/workspace.test.ts` ✅
    - desktop tests passed (85/85 in run scope).
  - `timeout 35s pnpm tauri:dev` ✅
    - Vite + Tauri dev app launched cleanly without immediate startup panic in terminal output.
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/App.settings-updater.test.tsx src/store/workspace.test.ts src/components/TerminalPane.test.tsx` ✅
    - desktop tests passed (92/92).
  - `cargo test -q` (in `apps/desktop/src-tauri`) ✅
    - Rust tests passed (16/16).
  - `cargo check -q` (in `apps/desktop/src-tauri`) ✅
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts src/components/TerminalPane.test.tsx` ✅
    - desktop tests passed (93/93 in run scope).
  - `pnpm --filter @supervibing/desktop typecheck` ✅
  - `cargo test -q` (in `apps/desktop/src-tauri`) ✅
    - Rust tests passed (20/20).
  - `cargo check -q` (in `apps/desktop/src-tauri`) ✅
  - `timeout 55s pnpm tauri:dev` ✅
    - with `127.0.0.1:47631` occupied, backend logged fallback bind success on `127.0.0.1:47632`.
  - `python3 ~/.codex/skills/supervibing-automation/scripts/supervibing_automation.py --json health` ✅
    - wrapper output now includes `baseUrl` alongside health payload.
  - `pnpm --filter @supervibing/desktop test -- run src/App.shortcuts.test.ts` ✅
    - desktop tests passed (94/94 in run scope).

- Blockers/Bugs:
  - Historical note: failed tag `v0.1.12` remains in history (manifest mismatch); immutable recovery was shipped as successful `v0.1.13`.
  - Discord toggle freeze is addressed in backend architecture; manual packaged-app verification with Discord open/closed is still pending.
  - No functional blockers identified.
  - User-reported React stack flood (`forceStoreRerender/updateStoreInstance`) is addressed in selector wiring; browser-console confirmation in the reporter environment is still pending.
  - Packaged-app Linux compositor compatibility still depends on host WebKit/GPU stack; diagnostics documented in `docs/architecture.md`.
  - Automation bearer-token auth is optional and env-driven; hosts that need stricter local protection should set `SUPERVIBING_AUTOMATION_TOKEN`.
  - Non-fatal shell startup warnings (`fnm/starship` permission and nvm prefix warnings) continue in command output and do not affect build/test outcomes.
  - Live skill smoke tests for `workspaces`/job execution remain blocked until SuperVibing desktop is running and serving the automation port.
  - By design, app tmux shortcut handling now captures `Ctrl+B` in eligible terminal scope; shell tmux users may need a non-default prefix or app shortcut changes.
  - New Git section GitHub actions depend on host `gh` CLI auth/session; unauthenticated hosts will surface backend command errors until `gh auth login` is completed.

- Next immediate starting point:
  - Manual validation pass for new `Git` section:
    - validate keyboard flows (`j/k`, `enter`, `r`, `s`, `d`, `c`, `b/p/i`, `a`, `x`) in active repository workspace,
    - validate PR/issue/action operations on a repo with `gh` auth configured,
    - validate destructive confirmation flows for discard/delete/merge/cancel actions.
  - Manual Discord Rich Presence validation pass:
    - verify `Settings -> Show activity in Discord` no longer freezes when Discord is open,
    - verify toggle remains responsive when Discord is closed and reconnects after Discord starts,
    - verify presence appears when Discord IPC is on non-zero slot (`discord-ipc-1..9`) environments.
  - Manual UX pass for pane worktree creation/reassignment:
    - verify `Ctrl+B` then `W` opens floating pane creator from terminal scope,
    - verify new pane creation against both existing and newly created worktrees,
    - verify running-pane worktree reassignment confirmation and restart behavior.
  - Manual UX pass for the new workspace path picker:
    - verify `Browse` opens native directory dialog and selected path is preserved on create,
    - verify cancel path-picker keeps current typed path unchanged,
    - verify picker error state clears after typing/reset.
  - Use guarded release checklist for future versions:
    - `pnpm run release:prepare -- X.Y.Z`,
    - commit version parity changes,
    - `pnpm run release:tag -- X.Y.Z`,
    - push `refs/heads/main` and `refs/tags/vX.Y.Z`,
    - monitor `Release` workflow completion.
  - Manual UX pass:
    - verify settings-edited startup commands are applied for new workspaces and imports,
    - verify app pane prefix `Ctrl+B` works while cursor is inside active xterm pane and while terminal panes are not focused.
  - Automation fallback validation pass:
    - launch app with `SUPERVIBING_AUTOMATION_BIND=127.0.0.1:47631` while `47631` is occupied and verify fallback range bind selection,
    - verify CLI auto-discovery by running wrapper without `--base-url` or `SUPERVIBING_AUTOMATION_URL`.
  - Automation smoke run with auth enabled:
    - launch app with `SUPERVIBING_AUTOMATION_TOKEN=<token>`,
    - validate `401` on missing token and success with valid `Bearer` token.
  - Keep Linux compositor diagnostics in the loop for black-screen reports:
    - `pnpm tauri:debug`,
    - `WEBKIT_DISABLE_DMABUF_RENDERER=1 pnpm tauri:debug`,
    - `WEBKIT_DISABLE_COMPOSITING_MODE=1 pnpm tauri:debug`.
